let scaleBubbles_capacity=.8*3,scaleBubbles_volume=0,nodePositionCircleArea_radius=60,updateAssetBubbleIDs_precursor=[],updateAssetBubbleIDs_ready=[],updateAssetBubbleIDs_Netten_precursor=[],updateAssetBubbleIDs_Netten_ready=[],updateGraphViews=[],updateTransmissionGridViews={},simulationAlpha=.03,minimumBubbleSize=2;var redrawDonutChartsTimeout;let testcase="2001";var dataNodes={type:"FeatureCollection",features:([{type:"Feature",properties:{Name:"Vancouver"},geometry:{type:"Point",coordinates:[-122.34374999999999,49.32512199104001]}},{type:"Feature",properties:{Name:"Calgary"},geometry:{type:"Point",coordinates:[-114.08203125,51.09662294502995]}},{type:"Feature",properties:{Name:"Edmonton"},geometry:{type:"Point",coordinates:[-113.51074218749999,53.56641415275043]}},{type:"Feature",properties:{Name:"Prince George"},geometry:{type:"Point",coordinates:[-122.78320312499999,53.93021986394]}},{type:"Feature",properties:{Name:"Fort St. John"},geometry:{type:"Point",coordinates:[-120.80566406250001,56.24334992410525]}},{type:"Feature",properties:{Name:"Prince Rupert"},geometry:{type:"Point",coordinates:[-130.3857421875,54.34214886448341]}},{type:"Feature",properties:{Name:"Fort McMurray"},geometry:{type:"Point",coordinates:[-111.26953125,56.65622649350222]}}],[])},dataLines=[];let blinderActive,currentAssetsViewConfig,currentSuns,currentGroupReferenceTable,currentRadiusArray=[],assetsCount=0,currentlySelectedAssetOriginalCXCY=0,currentPositionVraagAanbod="aanbod",currentViewLocatieTotalen="locatie",currentEnergy="elektriciteit",newAssetBubbleSetFlag=!0,drawNetdeelVollasturen_callCounter=0;const electricityGridColor="#999";function initOverviews(t){return new Promise((t=>{drawAssetsOverview(assetsOverviewConfig_Aanbod_Elektriciteit),mainAssetViewLoadedStatusFlag=!0,t()}))}var assetsOverviewMap;function drawAssetsOverview(t){currentAssetsViewConfig=t,mainAssetViewLoadedStatusFlag&&(document.getElementById(t.target+"_statusBar").innerHTML="",document.getElementById(t.target+"_footer").innerHTML="",d3.select("#assetsViewSVGMapOverlay").remove(),document.getElementById(t.target+"_overlay").innerHTML="",document.getElementById(t.target+"_overlay2").innerHTML="",document.getElementById(t.target+"_overlayBlinder").innerHTML="",document.getElementById(t.target+"_overlay3").innerHTML="",document.getElementById(t.target+"_dialog").innerHTML="",currentRadiusArray=[],updateAssetBubbleIDs_Netten_precursor=[],d3.selectAll("#donutChartElementNetbelastingG").remove(),drawNetdeelVollasturen_callCounter=0);mainAssetViewLoadedStatusFlag||((assetsOverviewMap=L.map(t.target+"_map",{scrollWheelZoom:!1,boxZoom:!1,doubleClickZoom:!1,dragging:!1,minZoom:8,maxZoom:8,zoomAnimation:!0,zoomControl:!1,touchZoom:!1}).setView([100,5.33],8)).attributionControl.setPrefix(!1),assetsOverviewMap.getContainer().style.backgroundColor="white",fetch("NLsolid.geojson").then((t=>t.json())).then((t=>{L.geoJSON(t,{style:function(t){return{color:"red",fillColor:"#888",weight:0}},interactive:!1}).addTo(assetsOverviewMap)}))),window["dataAssetsFiltered_"+t.target]=[];var e=[],a=[],r=[],s=[],n=[],o=[];for(let i=0;i<Object.keys(t.scopeAssets).length;i++){const l=Object.keys(t.scopeAssets)[i],d=t.scopeAssets[Object.keys(t.scopeAssets)[i]].assetType,c=t.scopeAssets[Object.keys(t.scopeAssets)[i]].resultid,u=t.scopeAssets[Object.keys(t.scopeAssets)[i]].energy,p=t.scopeAssets[Object.keys(t.scopeAssets)[i]].legend,g=t.scopeAssets[Object.keys(t.scopeAssets)[i]].typeA;e.push(d),a.push(c),r.push(l),s.push(u),n.push(p),o.push(g)}for(let i=0;i<loadedFiles.assetsOverview.length;i++){const l=loadedFiles.assetsOverview[i],d=e.reduce(((t,e,a)=>(l.name.includes(e)&&t.push(a),t)),[]);d.length>0&&d.forEach((i=>{const d={...l},c=e[i],u=a[i],p=(r[i],s[i]),g=n[i],y=o[i];d.assetCode=c,d.legend=g,d.typeA=y,d.resultid=u,d.energy=p,d.inputConfig=l.inputData.data[0],-1===d.indicator.indexOf("_consommation")&&-1===d.indicator.indexOf("_production")&&(d.indicator=d.indicator+p+"_"+u),d.energy!==d["consumption.energy"]&&d.energy!==d["fuel_consumption.energy"]&&d.energy!==d["production.energy"]||window["dataAssetsFiltered_"+t.target].push(d)}))}L.svg({clickable:!0}).addTo(assetsOverviewMap);const l=d3.select(assetsOverviewMap.getPanes().overlayPane).select("svg").attr("pointer-events","auto").append("g");mainAssetViewLoadedStatusFlag||d3.select("#"+t.target+"_header").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_headerSVG");let d=d3.select("#"+t.target+"_headerSVG").append("g");d3.select("#"+t.target+"_overlay").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_overlaySVG").style("pointer-events","none");let c=d3.select("#"+t.target+"_overlaySVG").append("g").style("pointer-events","none");d3.select("#"+t.target+"_overlay2").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_overlaySVG2").style("pointer-events","none");let u=d3.select("#"+t.target+"_overlaySVG2").append("g").style("pointer-events","none");d3.select("#"+t.target+"_overlayBlinder").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_overlaySVGBlinder").style("pointer-events","none");let p=d3.select("#"+t.target+"_overlaySVGBlinder").append("g").style("pointer-events","none");d3.select("#"+t.target+"_overlay3").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_overlaySVG3").style("pointer-events","none");d3.select("#"+t.target+"_overlaySVG3").append("g").style("pointer-events","none");d3.select("#"+t.target+"_statusBar").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_statusBarSVG").style("pointer-events","none");let g=d3.select("#"+t.target+"_statusBarSVG").append("g").style("pointer-events","none");d3.select("#"+t.target+"_blinderAssetsSwitch").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_blinderAssetsSwitchSVG").style("pointer-events","none");d3.select("#"+t.target+"_blinderAssetsSwitchSVG").append("g").style("pointer-events","none");d3.select("#"+t.target+"_footer").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_footerSVG").style("pointer-events","none");let y=d3.select("#"+t.target+"_footerSVG").append("g");d3.selectAll("#netCapacityFactorPath").style("visibility","visible"),d3.selectAll(".arc-background").style("visibility","visible"),d3.selectAll(".capacities").style("visibility","visible"),d3.selectAll(".detailsIndicator").style("visibility","hidden");const _=d3.select("#"+t.target+"_footerSVG").append("defs").append("pattern").attr("id","dots").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8);function h(e,a,r,s,n){var o=document.getElementById(t.target+"_dialog").offsetWidth-80;for(console.log(r),i=0;i<assetsCount;i++)d3.select("#assetsView_assetBubble_"+i).style("visibility","hidden"),d3.select("#donutChartGelement_assetsView_"+i).style("visibility","hidden");console.log(r[0]),console.log(r[1]),console.log(updateTransmissionGridViews["dataLines_"+t.target]),console.log(n);const l=updateTransmissionGridViews["dataLines_"+t.target].findIndex((t=>t.indicator+"_production"==r[0]));updateTransmissionGridViews["dataLines_"+t.target].findIndex((t=>t.indicator+"_production"==r[1]));d3.select("#"+t.target+"_dialog").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_dialogSVG");let d=d3.select("#"+t.target+"_dialogSVG").append("g");d3.select("#"+t.target+"_dialog").style("visibility","visible"),d.append("rect").attr("width",1150).attr("height",d3.select("#"+t.target+"_dialog").node().getBoundingClientRect().height).attr("fill","#FFF").style("opacity",.9),d.append("rect").attr("width",1150).attr("height",100).attr("fill","#546689").style("opacity",1),d.append("text").style("dominant-baseline","middle").attr("fill","white").attr("x",80).attr("y",55).style("font-size","30px").text("Asset"),d.append("rect").attr("width",1150).attr("height",d3.select("#"+t.target+"_dialog").node().getBoundingClientRect().height+200).attr("y",100).attr("fill","#FFFFFF").style("opacity",1),d.append("text").style("dominant-baseline","middle").attr("x",80).attr("y",170).style("font-size","30px").text(n[0]),d.append("text").style("dominant-baseline","middle").attr("x",80).attr("y",660).style("font-size","30px").text(n[1]),d.append("rect").attr("id","closeRect").attr("width",70).attr("height",70).attr("x",o-50+3).attr("y",135).attr("fill","white").attr("rx",35).attr("ry",35).style("pointer-events","all").on("mouseover",(function(){d3.select("#closeRect").attr("fill","#aaa"),d3.select("#closeCross").attr("fill","#FFF")})).on("mouseout",(function(){d3.select("#closeRect").attr("fill","#FFF"),d3.select("#closeCross").attr("fill","#333")})).on("click",(function(){for(i=0;i<updateGraphViews.length;i++)if(updateGraphViews[i].targetDiv==t.target+"_graphContainer1"){updateGraphViews.splice(i,1);break}for(i=0;i<updateGraphViews.length;i++)updateGraphViews[i].targetDiv==t.target+"_graphContainer2"&&updateGraphViews.splice(i,1);for(d3.select("#"+t.target+"_dialog").selectAll("*").remove(),d3.select("#"+t.target+"_dialog").style("visibility","hidden"),i=0;i<assetsCount;i++)d3.select("#assetsView_assetBubble_"+i).style("visibility","visible"),d3.select("#donutChartGelement_assetsView_"+i).style("visibility","visible")}));let c=o-50+10;d.append("path").attr("id","closeCross").style("pointer-events","none").attr("d","m250.923-218.924-31.999-31.999L448.001-480 218.924-709.077l31.999-31.999L480-511.999l229.077-229.077 31.999 31.999L511.999-480l229.077 229.077-31.999 31.999L480-448.001 250.923-218.924Z").attr("transform","translate("+c+",200)scale(0.06)").attr("fill","#000").style("opacity",1),d.append("rect").attr("width",70).attr("height",35).attr("x",o-100+30).attr("y",1040).attr("fill","white").style("pointer-events","all").style("stroke","#154273").on("click",(function(){for(i=0;i<updateGraphViews.length;i++)if(updateGraphViews[i].targetDiv==t.target+"_graphContainer1"){updateGraphViews.splice(i,1);break}for(i=0;i<updateGraphViews.length;i++)updateGraphViews[i].targetDiv==t.target+"_graphContainer2"&&updateGraphViews.splice(i,1);for(d3.select("#"+t.target+"_dialog").selectAll("*").remove(),d3.select("#"+t.target+"_dialog").style("visibility","hidden"),i=0;i<assetsCount;i++)d3.select("#assetsView_assetBubble_"+i).style("visibility","visible").style("pointer-events","all"),d3.select("#donutChartGelement_assetsView_"+i).style("visibility","visible")})),d.append("text").style("pointer-events","none").attr("x",o-100+17+30).attr("y",1063).style("font-size","18px").attr("fill","#000").text("Sluit");o=document.getElementById(t.target+"_dialog").offsetWidth-80;d3.select("#"+t.target+"_dialog").append("div").style("position","absolute").style("left","40px").style("top","230px").style("width",o+"px").style("height","300px").style("background-color","white").attr("id",t.target+"_graphContainer1");t.titleA,t.titleB,updateTransmissionGridViews["dataLines_"+t.target][l].name,updateTransmissionGridViews["dataLines_"+t.target][l].assetZone;updateGraphViews.push({indicator:r[0],targetDiv:t.target+"_graphContainer1",color:"#546689"}),drawAreaGraph({indicator:r[0],targetDiv:t.target+"_graphContainer1",color:"#546689"});o=document.getElementById(t.target+"_dialog").offsetWidth-80;d3.select("#"+t.target+"_dialog").append("div").style("position","absolute").style("left","40px").style("top","700px").style("width",o+"px").style("height","300px").style("background-color","none").attr("id",t.target+"_graphContainer2"),updateGraphViews.push({indicator:r[1],targetDiv:t.target+"_graphContainer2",color:"#546689"}),drawAreaGraph({indicator:r[1],targetDiv:t.target+"_graphContainer2",color:"#546689"})}_.append("rect").attr("width",8).attr("height",8).attr("fill","#FFF").style("opacity",.5),_.append("rect").attr("width",3).attr("height",3).attr("rx",1).attr("ry",1).attr("x",2).attr("fill","#DCEAF6"),function(){let e=loadedFiles.superGridContext.data_config_NODE;nodesDataStore=e;var a={type:"FeatureCollection",features:[]};for(i=0;i<e.length;i++)excludeNodesFromVisuals.includes(e[i].nodelabel)||a.features.push({type:"Feature",properties:{Name:e[i].name},geometry:{type:"Point",coordinates:[parseFloat(e[i].longitude),parseFloat(e[i].latitude)]}});var r=L.geoJSON(a);assetsOverviewMap.fitBounds(r.getBounds()),logGeoPositions=[];const s=l.selectAll("text").attr("class","nodeLabels").data(a.features).join("circle").attr("r",10).attr("fill","#333").style("visibility","hidden").attr("id",(function(t){return logGeoPositions.push({nodeID:"pos_"+t.properties.Name,x:0,y:0}),"pos_"+t.properties.Name}));s.attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x+20)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y+10)),logGeoPositions.forEach((function(t,e){logGeoPositions[e].x=d3.select("#"+t.nodeID).attr("cx"),logGeoPositions[e].y=d3.select("#"+t.nodeID).attr("cy")})),function(){t=currentAssetsViewConfig;let e=[],a={},r=0;logGeoPositions.forEach((function(t,i){e.push({group:i,id:t.nodeID.substring(4),x:parseInt(t.x),y:parseInt(t.y)}),a[t.nodeID.substring(4)]=r,r++})),t.alternateViewA.positions.forEach((function(i){e.push({group:r,id:i.title,typeA:i.typeA,x:i.rect.x+i.rect.width/2+t.alternateViewA.shiftPositions.x,y:i.rect.y+i.rect.height/2+t.alternateViewA.shiftPositions.y}),a[i.typeA]=r,r++})),currentGroupReferenceTable=a,currentSuns=e;const s=Object.keys(t.legend).map((t=>t));var n=30,o=30;for(i=0;i<s.length;i++)y.append("circle").attr("r",8).attr("cx",n).attr("cy",o).attr("fill",t.legend[s[i]]),y.append("text").attr("x",n+20).attr("y",o+5).style("font-weight",300).style("font-size","16px").style("text-anchor","start").attr("fill","#777").text(s[i]),n+50<900?n+=50+getTextWidth(s[i],"16px","RijksoverheidSans"):(n=30,o=70);if(!mainAssetViewLoadedStatusFlag){function l(){!async function(){d3.select("#assetsView_blinderAssetsSwitch").style("visibility","visible"),d3.select("#assetsView_footer").style("visibility","hidden"),d3.select("#assetsView_statusBar").style("visibility","hidden"),await new Promise((t=>setTimeout(t,100))),await new Promise((t=>{switch(newAssetBubbleSetFlag=!0,assetsCount=0,currentPositionVraagAanbod){case"vraag":switch(currentEnergy){case"elektriciteit":drawAssetsOverview(assetsOverviewConfig_Vraag_Elektriciteit);break;case"methaan":drawAssetsOverview(assetsOverviewConfig_Vraag_Methaan);break;case"warmte":drawAssetsOverview(assetsOverviewConfig_Vraag_Warmte);break;case"proceswarmte":drawAssetsOverview(assetsOverviewConfig_Vraag_Proceswarmte);break;case"zon":drawAssetsOverview(assetsOverviewConfig_Vraag_Zon);break;case"wind":drawAssetsOverview(assetsOverviewConfig_Vraag_Wind);break;case"waterstof":drawAssetsOverview(assetsOverviewConfig_Vraag_Waterstof);break;case"kolen":drawAssetsOverview(assetsOverviewConfig_Vraag_Kolen);break;case"biomassa":drawAssetsOverview(assetsOverviewConfig_Vraag_Biomassa);break;case"olie":drawAssetsOverview(assetsOverviewConfig_Vraag_Olie);break;case"ammoniak":drawAssetsOverview(assetsOverviewConfig_Vraag_Ammoniak);break;case"uranium":drawAssetsOverview(assetsOverviewConfig_Vraag_Uranium)}break;case"aanbod":switch(currentEnergy){case"elektriciteit":drawAssetsOverview(assetsOverviewConfig_Aanbod_Elektriciteit);break;case"methaan":drawAssetsOverview(assetsOverviewConfig_Aanbod_Methaan);break;case"warmte":drawAssetsOverview(assetsOverviewConfig_Vraag_Warmte);break;case"proceswarmte":drawAssetsOverview(assetsOverviewConfig_Aanbod_Proceswarmte);break;case"zon":drawAssetsOverview(assetsOverviewConfig_Aanbod_Zon);break;case"wind":drawAssetsOverview(assetsOverviewConfig_Aanbod_Wind);break;case"waterstof":drawAssetsOverview(assetsOverviewConfig_Aanbod_Waterstof);break;case"kolen":drawAssetsOverview(assetsOverviewConfig_Aanbod_Kolen);break;case"biomassa":drawAssetsOverview(assetsOverviewConfig_Aanbod_Biomassa);break;case"olie":drawAssetsOverview(assetsOverviewConfig_Aanbod_Olie);break;case"ammoniak":drawAssetsOverview(assetsOverviewConfig_Aanbod_Ammoniak);break;case"uranium":drawAssetsOverview(assetsOverviewConfig_Aanbod_Uranium)}break;default:console.log("ERROR - assetView config not available")}t()}))}()}d.append("text").attr("x",50).attr("y",60).style("font-weight",300).style("font-size","25px").style("text-anchor","start").attr("fill","white").text("Vraag, aanbod en netten"),d.append("rect").attr("id",t.target+"_standardView").attr("class",t.target+"_buttonRectLocatieTotalen").attr("x",371).attr("y",15).attr("width",80).attr("height",30).style("stroke","white").style("stroke-width",1).attr("fill","#FFF").on("click",(function(){A("standardView"),b(window["dataAssetsFiltered_"+t.target],currentSuns,nodeAssetBase,"node"),d3.selectAll("."+t.target+"_buttonRectLocatieTotalen").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonTextLocatieTotalen").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_standardView_text").attr("class",t.target+"_buttonTextLocatieTotalen").style("pointer-events","none").attr("x",411).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","#154273").text("Locatie"),d.append("rect").attr("id",t.target+"_alternateViewA").attr("class",t.target+"_buttonRectLocatieTotalen").attr("x",371).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",80).attr("height",30).on("click",(function(){A("alternateViewA"),b(window["dataAssetsFiltered_"+t.target],currentSuns,nodeAssetBase,"typeA"),d3.selectAll("."+t.target+"_buttonRectLocatieTotalen").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonTextLocatieTotalen").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_alternateViewA_text").attr("class",t.target+"_buttonTextLocatieTotalen").style("pointer-events","none").attr("x",411).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text(t.alternateViewA.buttonTitle),d.append("rect").attr("x",465).attr("y",32).attr("width",1).attr("height",40).attr("fill","white").style("stroke","none").style("stroke-width",1),d.append("rect").attr("id",t.target+"_button_vraag").attr("class",t.target+"_buttonRect_VraagAanbod").attr("x",479).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",80).attr("height",30).on("click",(function(){currentPositionVraagAanbod="vraag",d3.selectAll("."+t.target+"_buttonRect_VraagAanbod").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_VraagAanbod").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273"),l()})),d.append("text").attr("id",t.target+"_button_vraag_text").attr("class",t.target+"_buttonText_VraagAanbod").style("pointer-events","none").attr("x",521).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Vraag"),d.append("rect").attr("id",t.target+"_button_aanbod").attr("class",t.target+"_buttonRect_VraagAanbod").attr("x",479).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#FFFFFF").attr("width",80).attr("height",30).on("click",(function(){currentPositionVraagAanbod="aanbod",d3.selectAll("."+t.target+"_buttonRect_VraagAanbod").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_VraagAanbod").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273"),l()})),d.append("text").attr("id",t.target+"_button_aanbod_text").attr("class",t.target+"_buttonText_VraagAanbod").style("pointer-events","none").attr("x",521).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","#536588").text("Aanbod"),d.append("rect").attr("x",572).attr("y",32).attr("width",1).attr("height",40).attr("fill","white").style("stroke","none").style("stroke-width",1),d.append("rect").attr("id",t.target+"_button_elektriciteit").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",586).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#FFFFFF").attr("width",100).attr("height",30).on("click",(function(){currentEnergy="elektriciteit",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_elektriciteit_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",637).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","#154273").text("Elektriciteit"),d.append("rect").attr("id",t.target+"_button_methaan").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",696).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",75).attr("height",30).on("click",(function(){currentEnergy="methaan",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_methaan_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",734).attr("y",34.5).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Methaan"),d.append("rect").attr("id",t.target+"_button_warmte").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",781).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",73).attr("height",30).on("click",(function(){currentEnergy="warmte",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_warmte_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",818).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Warmte"),d.append("rect").attr("id",t.target+"_button_proceswarmte").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",864).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",111).attr("height",30).on("click",(function(){currentEnergy="proceswarmte",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_proceswarmte_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",920).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Proceswarmte"),d.append("rect").attr("id",t.target+"_button_waterstof").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",586).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",90).attr("height",30).on("click",(function(){currentEnergy="waterstof",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_waterstof_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",631).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Waterstof"),d.append("rect").attr("id",t.target+"_button_kolen").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",686).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",60).attr("height",30).on("click",(function(){currentEnergy="kolen",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_kolen_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",716).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Kolen"),d.append("rect").attr("id",t.target+"_button_biomassa").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",756).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",85).attr("height",30).on("click",(function(){currentEnergy="biomassa",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_biomassa_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",798).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Biomassa"),d.append("rect").attr("id",t.target+"_button_olie").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",850).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",43).attr("height",30).on("click",(function(){currentEnergy="olie",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_olie_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",872).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Olie"),d.append("rect").attr("id",t.target+"_button_ammoniak").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",902).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",88).attr("height",30).on("click",(function(){currentEnergy="ammoniak",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_ammoniak_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",946).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Ammoniak"),d.append("rect").attr("id",t.target+"_button_wind").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",1037).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",52).attr("height",30).on("click",(function(){currentEnergy="wind",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_wind_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",1063).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Wind"),d.append("rect").attr("id",t.target+"_button_zon").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",984).attr("y",15).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",44).attr("height",30).on("click",(function(){currentEnergy="zon",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_zon_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",1006).attr("y",35).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Zon"),d.append("rect").attr("id",t.target+"_button_uranium").attr("class",t.target+"_buttonRect_EnergySelection").attr("x",999).attr("y",55).style("stroke","white").style("stroke-width",1).attr("fill","#536588").attr("width",75).attr("height",30).on("click",(function(){currentEnergy="uranium",l(),d3.selectAll("."+t.target+"_buttonRect_EnergySelection").attr("fill","#536588"),d3.selectAll("."+t.target+"_buttonText_EnergySelection").attr("fill","white"),d3.select(this).attr("fill","white"),d3.select("#"+d3.select(this)._groups[0][0].id+"_text").attr("fill","#154273")})),d.append("text").attr("id",t.target+"_button_uranium_text").attr("class",t.target+"_buttonText_EnergySelection").style("pointer-events","none").attr("x",1036).attr("y",75).style("font-weight",300).style("font-size","16px").style("text-anchor","middle").attr("fill","white").text("Uranium")}var _=d3.select("#"+t.target+"_overlaySVG3").append("g");window["data_"+t.target]=[];let h=[];var m;logGeoPositions.forEach((t=>{h.push(t.nodeID.substring(4))})),window["dataAssetsFiltered_"+t.target].forEach((e=>{if("pmax"in e||"maxvalue"in e.outputData[0]){const a=Object.keys(t.scopeAssets).map((t=>t));for(j=0;j<a.length;j++)if(detectAssetCode=a[j],e.name.includes(a[j])){m=e.typeA,detectLegend=e.legend;break}const r=h.findIndex((t=>e.node.includes(t)));let s=0;for(i=0;i<timeseriesLib.length;i++)s+=parseFloat(timeseriesLib[i][e.indicator]);let n=0,o=selectedTestCase+"_"+e.name+"_co2_production";if(o in timeseriesLib[0])for(i=0;i<timeseriesLib.length;i++)n+=parseFloat(timeseriesLib[i][o]);let l=0;const d=e.outputData.findIndex((t=>t.idresult===e.resultid&&t.indicator.includes("_"+e.energy+"_")));l=e.outputData[d].maxvalue,window["data_"+t.target].push({target:t.target,name:e.name,energy:e.energy,group:r,value:l,typeA:m,typeB:void 0,assetCode:detectAssetCode,node:e.node,legend:detectLegend,indicator:e.indicator,volumeCumulative:s,CO2emissionsCumulative:n})}}));let f=0,x=0,v=0;function b(e,a,r,s){let n,o=function(t){const e={nodes:[],typeA:[]};return t.forEach((t=>{const a={x:t.x,y:t.y,id:t.typeA||t.id};t.typeA?e.typeA.push(a):e.nodes.push(a)})),e}(a),l=o.nodes,d=o.typeA;if("node"===s)n=e.map((t=>{let e=l.find((e=>e.id===t.node));return{id:t.node,x:e.x,y:e.y}}));else{if("typeA"!==s)return void console.error("Invalid input. Please provide 'node' or 'typeA'.");n=e.map((t=>{let e=d.find((e=>e.id===t.typeA));return{id:t.typeA,x:e.x,y:e.y}}))}r.data(n).each((function(t,e){var a=this.id,i=document.querySelector("#"+a).getAttribute("data-radius");d3.select(this).attr("data-radius",i),n[e].radius=i,n[e].assetbubble=a}));let c=function(t){const e={};return t.forEach((t=>{const a=`${t.x}_${t.y}`;e[a]?e[a].push(t):e[a]=[t]})),Object.values(e)}(n);function u(t){t.forEach((t=>{t.radius=parseFloat(t.radius)+4}));const e=t[0].x,a=t[0].y,i=(d3.pack().size([500,500]),t.map((t=>({x:t.x-e,y:t.y-a,r:t.radius})))),r=d3.packSiblings(i);t.forEach(((t,i)=>{t.x=r[i].x+e,t.y=r[i].y+a}));const s=d3.packEnclose(r);return t.forEach(((t,i)=>{t.x=r[i].x+s.x+e,t.y=r[i].y+s.y+a})),t}let p=[];for(i=0;i<c.length;i++){let t=u(c[i]);p=p.concat(t)}let g=1e3;newAssetBubbleSetFlag?(newAssetBubbleSetFlag=!1,r.data(p).attr("cx",(function(e,a){let i=p.findIndex((t=>t.assetbubble===this.id));return d3.selectAll("#donutChartGelement_"+t.target+"_"+a).attr("transform","translate("+p[i].x+","+p[i].y+")"),p[i].x})).attr("cy",(function(t,e){let a=p.findIndex((t=>t.assetbubble===this.id));return p[a].y}))):(playState="paused",clearInterval(loop),setTimeout((()=>{playState="running",startPlaying()}),g),r.data(p).transition().duration(g).ease(d3.easeSin).attr("cx",(function(e,a){let i=p.findIndex((t=>t.assetbubble===this.id));return d3.selectAll("#donutChartGelement_"+t.target+"_"+a).transition().duration(g).ease(d3.easeSin).attr("transform","translate("+p[i].x+","+p[i].y+")"),p[i].x})).attr("cy",(function(t,e){let a=p.findIndex((t=>t.assetbubble===this.id));return p[a].y})))}function A(e){t=currentAssetsViewConfig,blinderActive=!1,"alternateViewA"==e&&(detailsIndicatorStatusFlag&&toggleDetailsIndicators(),d3.selectAll("#detailsIndicatorButton").style("visibility","hidden"),d3.select("#"+t.target+"_overlaySVG2").style("visibility","hidden"),d3.selectAll("#netCapacityFactorPath").style("opacity",0),0==blinderActive&&(p=d3.select("#"+t.target+"_overlaySVGBlinder").append("g").style("pointer-events","none"),p.append("rect").attr("id",t.target+"_blinder").attr("x",30).attr("y",0).attr("width",1080).attr("height",899).attr("fill","white").style("opacity",1),blinderActive=!0),window["data_"+t.target].forEach((function(e,a){for(d3.select("#"+t.target+"_page").text(t.alternateViewA.buttonTitle.toLowerCase()),window["data_"+t.target][a].group=currentGroupReferenceTable[window["data_"+t.target][a].typeA],i=0;i<t.alternateViewA.positions.length;i++)if(p.append("rect").attr("class",t.target+"_alternateViewObject_A").attr("x",t.alternateViewA.positions[i].rect.x-35).attr("y",t.alternateViewA.positions[i].rect.y-5).attr("width",10).attr("height",t.alternateViewA.positions[i].rect.height-10).attr("fill","#A7B3C6").style("stroke-width",0).style("opacity",0).style("opacity",.4),p.append("text").attr("class",t.target+"_alternateViewObject_A").attr("x",t.alternateViewA.positions[i].rect.x+20-30).attr("y",t.alternateViewA.positions[i].rect.y+30).style("font-weight",200).style("font-size","20px").style("text-anchor","start").attr("fill","#154273").text(t.alternateViewA.positions[i].title).style("opacity",0).style("opacity",1),"textIndicators"in t.alternateViewA.positions[i])for(j=0;j<t.alternateViewA.positions[i].textIndicators.length;j++)switch(t.alternateViewA.positions[i].textIndicators[j]){case"jaarProductie":var r=0,s=[];for(Object.keys(t.scopeAssets).forEach((e=>{t.alternateViewA.positions[i].typeA===t.scopeAssets[e].typeA&&s.push(e)})),k=0;k<s.length;k++)for(w=0;w<window["data_"+t.target].length;w++)window["data_"+t.target][w].assetCode==s[k]&&(r+=window["data_"+t.target][w].volumeCumulative);p.append("text").attr("class",t.target+"_alternateViewObject_A").attr("x",t.alternateViewA.positions[i].rect.x+20-30).attr("y",t.alternateViewA.positions[i].rect.y+60).text("Volume: "+numberWithThousandsSeperator(Math.round(r/1e6*10)/10)+" TWh, "+numberWithThousandsSeperator(Math.round(r/1e6*3.6))+" PJ");break;case"jaarConsumptie":var n=0;for(s=[],Object.keys(t.scopeAssets).forEach((e=>{t.alternateViewA.positions[i].typeA===t.scopeAssets[e].typeA&&-1===s.indexOf(t.scopeAssets[e].assetType)&&s.push(t.scopeAssets[e].assetType)})),k=0;k<s.length;k++)for(w=0;w<window["data_"+t.target].length;w++)window["data_"+t.target][w].assetCode==s[k]&&-1!=t.alternateViewA.positions[i].vectors.indexOf(window["data_"+t.target][w].energy)&&(n+=window["data_"+t.target][w].volumeCumulative);p.append("text").attr("class",t.target+"_alternateViewObject_A").attr("x",t.alternateViewA.positions[i].rect.x+20-30).attr("y",t.alternateViewA.positions[i].rect.y+60).text("Volume: "+numberWithThousandsSeperator(Math.round(n/1e6*10)/10)+" TWh, "+numberWithThousandsSeperator(Math.round(n/1e6*3.6))+" PJ");break;case"opgesteldeCapaciteit":var o=0;for(s=[],Object.keys(t.scopeAssets).forEach((e=>{t.alternateViewA.positions[i].typeA===t.scopeAssets[e].typeA&&s.push(e)})),k=0;k<s.length;k++)for(w=0;w<window["data_"+t.target].length;w++)window["data_"+t.target][w].assetCode==s[k]&&(o+=window["data_"+t.target][w].value);p.append("text").attr("class",t.target+"_alternateViewObject_A").attr("x",t.alternateViewA.positions[i].rect.x+20-30).attr("y",t.alternateViewA.positions[i].rect.y+85).text("Capaciteit: "+numberWithThousandsSeperator(Math.round(o))+" MW")}}))),"standardView"==e&&(d3.selectAll("#detailsIndicatorButton").style("visibility","visible"),d3.selectAll(".detailsIndicator").style("visibility","hidden"),detailsIndicatorStatusFlag=!1,d3.select("#"+t.target+"_overlaySVG2").style("visibility","visible"),d3.selectAll("#netCapacityFactorPath").style("opacity",1),C("A"),C("B"),d3.selectAll("#"+t.target+"_blinder").style("opacity",0),setTimeout((()=>{d3.selectAll("#"+t.target+"_blinder").remove()}),300),blinderActive=!1,window["data_"+t.target].forEach((function(e,a){window["data_"+t.target][a].group=currentGroupReferenceTable[window["data_"+t.target][a].node],d3.select("#"+t.target+"_page").text("locatie")})))}function C(e){d3.selectAll("."+t.target+"_alternateViewObject_"+e).style("opacity",0),setTimeout((()=>{d3.selectAll("."+t.target+"_alternateViewObject_"+e).remove()}),500)}asssetsCount=0,f=0,x=0,v=0,logGeoPositions.forEach((e=>{let a=30,i=0,r=0,s=0;if(interconnectorNodes.includes(e.nodeID.slice(4))){for(c.append("circle").attr("class","nodePositionCircleArea").attr("cx",e.x).attr("cy",e.y).attr("r",.5*nodePositionCircleArea_radius).attr("fill","lightgray").style("stroke","lightgray").style("stroke-width","2px").style("opacity",.8).style("pointer-events","none"),u.append("rect").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-50).attr("width",a).attr("height",a).attr("rx",10).attr("ry",10).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").style("text-anchor","middle").style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-50+20).text(getNodeID(e.nodeID.slice(4))),d3.selectAll(".detailsIndicator").style("visibility","hidden"),jax=0;jax<Object.keys(t.scopeAssets).length;jax++)for(jux=0;jux<window["data_"+t.target].length;jux++)e.nodeID.slice(4)==window["data_"+t.target][jux].node&&t.target==window["data_"+t.target][jux].target&&Object.keys(t.scopeAssets)[jax]===window["data_"+t.target][jux].assetCode&&(assetsCount++,s+=window["data_"+t.target][jux].CO2emissionsCumulative,v+=window["data_"+t.target][jux].CO2emissionsCumulative,-1!=window["data_"+t.target][jux].indicator.indexOf("_consommation")&&-1!=window["data_"+t.target][jux].indicator.indexOf("_"+t.energy)?(r+=window["data_"+t.target][jux].volumeCumulative,x+=window["data_"+t.target][jux].volumeCumulative):-1!=window["data_"+t.target][jux].indicator.indexOf("_production")&&-1!=window["data_"+t.target][jux].indicator.indexOf("_"+t.energy)&&(i+=window["data_"+t.target][jux].volumeCumulative,f+=window["data_"+t.target][jux].volumeCumulative));i=Math.round(i/1e6*3.6),r=Math.round(r/1e6*3.6),n="A "+i+"PJ",u.append("rect").attr("class","detailsIndicator").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-32+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15-15).attr("width",getTextWidth(n,"11px","RijksoverheidSans")+10+6).attr("height",20).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("font-weight",800).style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+5+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text("A"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("fill","#000").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15+10-10+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text(i+" PJ"),n="V "+r+"PJ",u.append("rect").attr("class","detailsIndicator").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2+32+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15-15).attr("width",getTextWidth(n,"11px","RijksoverheidSans")+10+6).attr("height",20).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("font-weight",800).style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+5+32+10+30).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text("V"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("fill","#000").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15+10-10+32+10+30).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text(r+" PJ"),n="E "+Math.round(s/1e5)/10+"Mton",u.append("rect").attr("class","detailsIndicator").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2+32+10-20).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-15-20).attr("width",getTextWidth(n,"11px","RijksoverheidSans")+10+6).attr("height",20).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("font-weight",800).style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+5+32+10+30-20).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-20).text("E"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("fill","#000").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15+10-10+32+10+30-20).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-20).text(Math.round(s/1e5)/10+" Mton")}else{for(c.append("circle").attr("class","nodePositionCircleArea").attr("cx",e.x).attr("cy",e.y).attr("r",nodePositionCircleArea_radius).attr("fill","white").style("stroke","lightgray").style("stroke-width","2px").style("opacity",.8).style("pointer-events","none"),u.append("rect").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-50).attr("width",a).attr("height",a).attr("rx",10).attr("ry",10).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").style("text-anchor","middle").style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-50+20).text(getNodeID(e.nodeID.slice(4))),jax=0;jax<Object.keys(t.scopeAssets).length;jax++)for(jux=0;jux<window["data_"+t.target].length;jux++)if(e.nodeID.slice(4)==window["data_"+t.target][jux].node&&t.target==window["data_"+t.target][jux].target&&Object.keys(t.scopeAssets)[jax]===window["data_"+t.target][jux].assetCode){assetsCount++,s+=window["data_"+t.target][jux].CO2emissionsCumulative,v+=window["data_"+t.target][jux].CO2emissionsCumulative;for(let e of t.energy)-1!=window["data_"+t.target][jux].indicator.indexOf("_consommation")&&-1!=window["data_"+t.target][jux].indicator.indexOf("_"+e)&&(r+=window["data_"+t.target][jux].volumeCumulative,x+=window["data_"+t.target][jux].volumeCumulative);for(let e of t.energy)-1!=window["data_"+t.target][jux].indicator.indexOf("_production")&&-1!=window["data_"+t.target][jux].indicator.indexOf("_"+e)&&(i+=window["data_"+t.target][jux].volumeCumulative,f+=window["data_"+t.target][jux].volumeCumulative)}i=Math.round(i/1e6*3.6),r=Math.round(r/1e6*3.6);var n="A "+i+"PJ";u.append("rect").attr("class","detailsIndicator").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-32+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15-15).attr("width",getTextWidth(n,"11px","RijksoverheidSans")+10+6).attr("height",20).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("font-weight",800).style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+5+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text("A"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("fill","#000").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15+10-10+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text(i+" PJ");n="V "+r+"PJ";u.append("rect").attr("class","detailsIndicator").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2+32+10).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15-15).attr("width",getTextWidth(n,"11px","RijksoverheidSans")+10+6).attr("height",20).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("font-weight",800).style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+5+32+10+30).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text("V"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("fill","#000").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15+10-10+32+10+30).attr("y",parseInt(e.y)-nodePositionCircleArea_radius+15).text(r+" PJ");n="E "+Math.round(s/1e5)/10+"Mton";u.append("rect").attr("class","detailsIndicator").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2+32+10-20).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-15-20).attr("width",getTextWidth(n,"11px","RijksoverheidSans")+10+6).attr("height",20).attr("fill","white").attr("opacity",1).style("stroke","#ccc"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("font-weight",800).style("fill","#999").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+5+32+10+30-20).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-20).text("E"),u.append("text").attr("class","detailsIndicator").style("text-anchor","left").style("font-size","11px").style("fill","#000").attr("x",parseInt(e.x)-nodePositionCircleArea_radius/2-30+15+10-10+32+10+30-20).attr("y",parseInt(e.y)+nodePositionCircleArea_radius+15-20).text(Math.round(s/1e5)/10+" Mton"),d3.selectAll(".detailsIndicator").style("visibility","hidden")}})),function(){var t=50;let e=assetsCount;g.append("text").attr("id","statusBarDefaultElement").style("font-size","16px").attr("x",t).attr("y",40).text("assets | "),t=t+getTextWidth("assets | ","16px","RijksoverheidSans")+5,g.append("text").style("font-size","16px").style("font-weight",800).attr("id","statusBarDefaultElement").attr("x",t).attr("y",40).text(e),t=t+getTextWidth(e,"17px","RijksoverheidSans")+15,g.append("text").attr("id","statusBarDefaultElement").style("font-size","16px").attr("x",t).attr("y",40).text("vraag | "),t=t+getTextWidth("vraag | ","16px","RijksoverheidSans")+5,g.append("text").style("font-size","16px").style("font-weight",800).attr("id","statusBarDefaultElement").attr("x",t).attr("y",40).text(Math.round(x/1e6*3.6)+" PJ"),t=t+getTextWidth(Math.round(x/1e6*3.6)+" PJ","17px","RijksoverheidSans")+15,g.append("text").attr("id","statusBarDefaultElement").style("font-size","16px").attr("x",t).attr("y",40).text("aanbod | "),t=t+getTextWidth("aanbod | ","16px","RijksoverheidSans")+5,g.append("text").style("font-size","16px").style("font-weight",800).attr("id","statusBarDefaultElement").attr("x",t).attr("y",40).text(Math.round(f/1e6*3.6)+" PJ")}(),function(){let a=[],r=[],s=[];for(i=0;i<e.length;i++)a.push(i),r.push(currentSuns[i].x),s.push(currentSuns[i].y);function n(t){return Math.sqrt(t/Math.PI)}d3.scaleOrdinal().domain(a).range(r),d3.scaleOrdinal().domain(a).range(s),updateAssetBubbleIDs_precursor=[],nodeAssetBase=_.append("g").selectAll("circle").data(window["data_"+t.target]).enter().append("circle").attr("class","assetBubble").attr("id",(function(e,a){return updateAssetBubbleIDs_precursor.push({index:a,value:e.value,domID:t.target+"_assetBubble_"+a,target:t.target,indicator:e.indicator}),t.target+"_assetBubble_"+a})).attr("cx",0).attr("cy",0).attr("data-statusBar",(function(t){let e=10*Math.round(t.volumeCumulative/1e6*3.6)/10;return'{"name": "'+t.name+'", "node": "'+t.node+'", "p": '+t.value+', "v": '+e+"}"})).attr("r",0).attr("data-radius",(function(e){return n(e.volumeCumulative)*t.scaleBubbles<minimumBubbleSize&&-1==e.indicator.indexOf("LOL")?(currentRadiusArray.push(n(e.volumeCumulative)*t.scaleBubbles),minimumBubbleSize):(currentRadiusArray.push(n(e.volumeCumulative)*t.scaleBubbles),n(e.volumeCumulative)*t.scaleBubbles)})).style("fill",(function(e){return t.legend[e.legend]})).style("fill-opacity",.9).attr("stroke","white").style("stroke-width",1).style("pointer-events","all").on("mouseover",(function(e){!function(e,a,i){let r=y.append("g").attr("id","hooverInfoElement");r.append("rect").attr("width",1150).attr("height",100).attr("fill","#FFF").style("opacity",1);var s=parseInt(a.id.replace(t.target+"_assetBubble_",""));function n(t){const e=t.replace(/(_[A-Z0-9]+|\.[A-Z0-9]{2})/g,"");return e.endsWith("_")?e.slice(0,-1):e}function o(t){const e=/_([A-Z0-9]{4})/,a=(t=t.replace("_TRANS","")).match(e);return a?a[1]:null}function l(t){const e=asset_types_lookup_table.find((e=>e.asset_type_id===t));return e?e.definition:null}function d(t){const e=energy_vectors_lookup_table.find((e=>e.vector===t));return e?e.definition:null}window["data_"+t.target][s].indicator,document.getElementById(t.target+"_dialog").offsetWidth,r.append("text").style("dominant-baseline","middle").attr("x",20).attr("y",27).style("font-weight",300).style("font-size","20px").text(n(window["data_"+t.target][s].name)),loadedFiles.assetsOverview[loadedFiles.assetsOverview.findIndex((e=>e.indicator===window["data_"+t.target][s].indicator))];var c=numberWithThousandsSeperator(Math.round(window["data_"+t.target][s].volumeCumulative/(8760*window["data_"+t.target][s].value)*100));d3.select("#"+t.target+"_footer").append("div").attr("id","energyFlowExplanationFooter").style("position","absolute").style("top","40px").style("left","20px").style("width","800px").style("height","250px");let u,p=o(window["data_"+t.target][s].indicator),g={0:"",1:""};"production"===t.scopeAssets[p].resultid&&(g[0]="productie",g[1]="produceert"),"consommation"===t.scopeAssets[p].resultid&&(g[0]="consumptie",g[1]="consumeert"),u=d(t.scopeAssets[p].energy);let _=l(p),h=window["data_"+t.target][s].node,w=numberWithThousandsSeperator(Math.round(window["data_"+t.target][s].value)),m=numberWithThousandsSeperator(Math.round(window["data_"+t.target][s].volumeCumulative/1e3)),f=(numberWithThousandsSeperator(Math.round(window["data_"+t.target][s].volumeCumulative/1e6)),numberWithThousandsSeperator(3.6*Math.round(window["data_"+t.target][s].volumeCumulative/1e6))),x=Math.round(c/100*8760);document.getElementById("energyFlowExplanationFooter").innerHTML=`\n       <p6>Dit is de <strong>${g[0]}</strong> van <strong>${u}</strong> door ${_}</strong> op node <strong>'${h}'</strong> <br> <strong>${w}</strong>  MW | <strong>${m}</strong>  GWh, <strong>${f}</strong> PJ | <strong>${x}</strong> vollasturen (<strong>${c}</strong>%)</p6>\n        `}(0,this,d3.select(this).style("fill"))})).on("mouseout",(function(){d3.selectAll("#energyFlowExplanationFooter").remove(),d3.selectAll("#hooverInfoElement").remove(),d3.selectAll("#statusBarDefaultElement").style("visibility","visible")})).on("click",(function(e){!function(e,a,r){for(i=0;i<assetsCount;i++)d3.select("#assetsView_assetBubble_"+i).style("visibility","hidden").style("pointer-events","none"),d3.select("#donutChartGelement_assetsView_"+i).style("visibility","hidden");let s=a.id.replace("assetsView_assetBubble_","");d3.select("#"+a.id).style("visibility","visible"),d3.select("#donutChartGelement_assetsView_"+s).style("visibility","visible");const n=800,o=130;currentlySelectedAssetOriginalCXCY={cx:a.cx.baseVal.value,cy:a.cy.baseVal.value},d3.select("#"+a.id).transition().duration(500).attr("cx",n).attr("cy",o),d3.select("#donutChartGelement_assetsView_"+s).transition().duration(500).attr("transform","translate("+n+","+o+")"),d3.select("#"+t.target+"_dialog").append("svg").style("width","100%").style("height","100%").attr("id",t.target+"_dialogSVG");let l=d3.select("#"+t.target+"_dialogSVG").append("g");d3.select("#"+t.target+"_dialog").style("visibility","visible"),l.append("rect").attr("width",1150).attr("height",100).attr("fill","#546689").style("opacity",1),l.append("rect").attr("width",1150).attr("height",d3.select("#"+t.target+"_dialog").node().getBoundingClientRect().height+200).attr("y",100).attr("fill","#FFFFFF").style("opacity",1),l.append("rect").attr("width",1012).attr("height",345).attr("x",50).attr("y",d3.select("#"+t.target+"_dialog").node().getBoundingClientRect().height-380+100).attr("fill","#eee").style("opacity",1),l.append("circle").attr("cx",n).attr("cy",280).attr("fill","#eee").attr("r",0).transition().duration(1e3).attr("r",70);var d=parseInt(a.id.replace(t.target+"_assetBubble_","")),c=window["data_"+t.target][d].indicator,u=document.getElementById(t.target+"_dialog").offsetWidth-80;function p(t){const e=t.replace(/(_[A-Z0-9]+|\.[A-Z0-9]{2})/g,"");return e.endsWith("_")?e.slice(0,-1):e}function g(t){const e=/_([A-Z0-9]{4})/,a=(t=t.replace("_TRANS","")).match(e);return a?a[1]:null}function y(t){const e=asset_types_lookup_table.find((e=>e.asset_type_id===t));return e?e.definition:null}function _(t){const e=energy_vectors_lookup_table.find((e=>e.vector===t));return e?e.definition:null}d3.select("#"+t.target+"_dialog").append("div").style("position","absolute").style("left","40px").style("top","420px").style("width",u+"px").style("height","300px").style("background-color","#fff").attr("id",t.target+"_graphContainer"),l.append("text").style("dominant-baseline","middle").attr("fill","white").attr("x",80).attr("y",55).style("font-size","30px").text("Asset"),l.append("text").style("dominant-baseline","middle").attr("x",80).attr("y",160).style("font-size","30px").text(p(window["data_"+t.target][d].name)),loadedFiles.assetsOverview[loadedFiles.assetsOverview.findIndex((e=>e.indicator===window["data_"+t.target][d].indicator))];var h=numberWithThousandsSeperator(Math.round(window["data_"+t.target][d].volumeCumulative/(8760*window["data_"+t.target][d].value)*100));d3.select("#"+t.target+"_dialog").append("div").attr("id","energyFlowExplanationDiv").style("position","absolute").style("top","200px").style("left","80px").style("width","500px").style("height","250px"),d3.select("#"+t.target+"_dialog").append("div").attr("id","modelAssetConfigDiv").style("position","absolute").style("top","830px").style("left","80px").style("width","940px").style("height","200px"),l.append("text").attr("x",80).attr("y",810).style("font-weight",300).style("font-size","24px").text("Assetconfiguratie");let w,m=g(window["data_"+t.target][d].indicator),f={0:"",1:""};"production"===t.scopeAssets[m].resultid&&(f[0]="productie",f[1]="produceert"),"consommation"===t.scopeAssets[m].resultid&&(f[0]="consumptie",f[1]="consumeert"),w=_(t.scopeAssets[m].energy);let x=y(m),v=window["data_"+t.target][d].node,b=numberWithThousandsSeperator(Math.round(window["data_"+t.target][d].value)),A=numberWithThousandsSeperator(Math.round(window["data_"+t.target][d].volumeCumulative/1e3)),C=(numberWithThousandsSeperator(Math.round(window["data_"+t.target][d].volumeCumulative/1e6)),numberWithThousandsSeperator(3.6*Math.round(window["data_"+t.target][d].volumeCumulative/1e6))),V=Math.round(h/100*8760)+" uur ("+h+"%)";function O(t){let e="";for(const a in t)t.hasOwnProperty(a)&&(e+=`<strong>${a}</strong>: ${t[a]}, `);return e=e.slice(0,-2),e}document.getElementById("energyFlowExplanationDiv").innerHTML=`\n       <p4>Dit is de <strong>${f[0]}</strong> van <strong>${w}</strong> door ${x}</strong> op node '${v}'. Het opgestelde vermogen is <strong>${b} MW</strong>. De asset ${f[1]} op jaarbasis <strong>${A} GWh (${C} PJ</strong>) ${w}. Vollasturen: ${V}. </p4>\n        `,document.getElementById("modelAssetConfigDiv").innerHTML=`\n      <p5>${O(window["dataAssetsFiltered_"+t.target][d].inputData.data[0])}</p5>\n        `,t.titleA,window["data_"+t.target][d].node,numberWithThousandsSeperator(window["data_"+t.target][d].value),numberWithThousandsSeperator(Math.round(window["data_"+t.target][d].volumeCumulative/1e3)),Math.round(h/100*8760),l.append("text").attr("x",140).attr("y",400).style("font-weight",100).style("font-size","14px").text("Indicator:"),l.append("text").attr("x",210).attr("y",400).style("font-weight",100).style("font-size","14px").text(window["data_"+t.target][d].indicator),updateGraphViews.push({indicator:c,targetDiv:t.target+"_graphContainer",color:r}),drawAreaGraph({indicator:c,targetDiv:t.target+"_graphContainer",color:r}),l.append("rect").attr("id","closeRect").attr("width",70).attr("height",70).attr("x",u-50+3).attr("y",135).attr("fill","white").attr("rx",35).attr("ry",35).style("pointer-events","all").on("click",(function(){for(i=0;i<updateGraphViews.length;i++)if(updateGraphViews[i].targetDiv==t.target+"_graphContainer"){updateGraphViews.splice(i,1),d3.select("#"+t.target+"_dialog").selectAll("*").remove(),d3.select("#"+t.target+"_dialog").style("visibility","hidden");break}for(i=0;i<assetsCount;i++)d3.select("#assetsView_assetBubble_"+i).style("visibility","visible").style("pointer-events","all"),d3.select("#donutChartGelement_assetsView_"+i).style("visibility","visible");let e=a.id.replace("assetsView_assetBubble_","");d3.select("#"+a.id).transition().duration(500).attr("cx",currentlySelectedAssetOriginalCXCY.cx).attr("cy",currentlySelectedAssetOriginalCXCY.cy),d3.select("#donutChartGelement_assetsView_"+e).transition().duration(500).attr("transform","translate("+currentlySelectedAssetOriginalCXCY.cx+","+currentlySelectedAssetOriginalCXCY.cy+")")})).on("mouseover",(function(){d3.select("#closeRect").attr("fill","#aaa"),d3.select("#closeCross").attr("fill","#FFF")})).on("mouseout",(function(){d3.select("#closeRect").attr("fill","#FFF"),d3.select("#closeCross").attr("fill","#333")}));let T=u-50+10;l.append("path").attr("id","closeCross").style("pointer-events","none").attr("d","m250.923-218.924-31.999-31.999L448.001-480 218.924-709.077l31.999-31.999L480-511.999l229.077-229.077 31.999 31.999L511.999-480l229.077 229.077-31.999 31.999L480-448.001 250.923-218.924Z").attr("transform","translate("+T+",200)scale(0.06)").attr("fill","#000").style("opacity",1),l.append("rect").attr("width",70).attr("height",35).attr("x",u-100+30).attr("y",1040).attr("fill","white").style("pointer-events","all").style("stroke","#154273").on("click",(function(){for(i=0;i<updateGraphViews.length;i++)if(updateGraphViews[i].targetDiv==t.target+"_graphContainer"){updateGraphViews.splice(i,1),d3.select("#"+t.target+"_dialog").selectAll("*").remove(),d3.select("#"+t.target+"_dialog").style("visibility","hidden");break}for(i=0;i<assetsCount;i++)d3.select("#assetsView_assetBubble_"+i).style("visibility","visible").style("pointer-events","all"),d3.select("#donutChartGelement_assetsView_"+i).style("visibility","visible");let e=a.id.replace("assetsView_assetBubble_","");d3.select("#"+a.id).transition().duration(500).attr("cx",currentlySelectedAssetOriginalCXCY.cx).attr("cy",currentlySelectedAssetOriginalCXCY.cy),d3.select("#donutChartGelement_assetsView_"+e).transition().duration(500).attr("transform","translate("+currentlySelectedAssetOriginalCXCY.cx+","+currentlySelectedAssetOriginalCXCY.cy+")")})),l.append("text").style("pointer-events","none").attr("x",u-100+17+30).attr("y",1063).style("font-size","18px").attr("fill","#000").text("Sluit")}(0,this,d3.select(this).style("fill"))})),nodeAssetBase.transition().duration(250).attr("r",(function(e,a){return n(e.volumeCumulative)*t.scaleBubbles<minimumBubbleSize&&-1==e.indicator.indexOf("LOL")?(currentRadiusArray.push(n(e.volumeCumulative)*t.scaleBubbles),minimumBubbleSize):(currentRadiusArray.push(n(e.volumeCumulative)*t.scaleBubbles),n(e.volumeCumulative)*t.scaleBubbles)})),setTimeout((()=>{initDonutCharts(),setTimeout((()=>{d3.select("#assetsView_blinderAssetsSwitch").style("visibility","hidden"),d3.select("#assetsView_footer").style("visibility","visible"),d3.select("#assetsView_statusBar").style("visibility","visible"),d3.select("#assetsView_standardView").attr("fill","white"),d3.select("#assetsView_alternateViewA").attr("fill","#536588"),d3.select("#assetsView_standardView_text").attr("fill","#536588"),d3.select("#assetsView_alternateViewA_text").attr("fill","white")}),250)}),250)}(),b(window["dataAssetsFiltered_"+t.target],currentSuns,nodeAssetBase,"node"),setTimeout((()=>{}),100)}()}(),t.drawElectricityGrid&&function(e){L.svg({clickable:!0}).addTo(assetsOverviewMap);const a=d3.select(assetsOverviewMap.getPanes().overlayPane),r=a.select("svg").attr("pointer-events","auto").append("g").attr("transform","translate(20,10)");r.attr("id","assetsViewSVGMapOverlay");var s={type:"FeatureCollection",features:[]};for(updateTransmissionGridViews["dataLines_"+t.target]=[],nodesData=loadedFiles.superGridContext.data_config_NODE,nodesDataStore=nodesData,i=0;i<nodesData.length;i++)excludeNodesFromVisuals.includes(nodesData[i].nodelabel)||s.features.push({type:"Feature",properties:{Name:nodesData[i].name},geometry:{type:"Point",coordinates:[parseFloat(nodesData[i].longitude),parseFloat(nodesData[i].latitude)]}});let n=loadedFiles.superGridContext.data_assets_TRANSMISSION;for(i=0;i<n.length;i++)if(transmissionLinesVisualSelection.includes(n[i]["consumption.node"])||transmissionLinesVisualSelection.includes(n[i]["production.node"]))if(updateTransmissionGridViews["dataLines_"+t.target].length>0){let e=!1;for(j=0;j<updateTransmissionGridViews["dataLines_"+t.target].length;j++)updateTransmissionGridViews["dataLines_"+t.target][j]["production.node"]==n[i]["consumption.node"]&&updateTransmissionGridViews["dataLines_"+t.target][j]["consumption.node"]==n[i]["production.node"]&&(e=!0);0==e?updateTransmissionGridViews["dataLines_"+t.target].push({availability:parseFloat(n[i].availability),assetZone:n[i]["asset zone"],capex:n[i].capex,consumptionCost:n[i]["consumption cost"],consumptionEnergy:n[i]["consumption.energy"],consumptionNode:n[i]["consumption.node"],fixedOperatingCost:n[i]["fixed operating costs"],losses:n[i].losses,maxPmax:n[i]["max pmax"],minPmax:n[i]["min pmax"],name:n[i].name,pmax:n[i].pmax,productionEnergy:n[i]["production.energy"],productionNode:n[i]["production.node"],selectedBehaviors:n[i]["selected behaviors"],susceptance:n[i].susceptance,indicator:testcase+"_"+n[i].name+"_"+n[i]["consumption.energy"],longitude:parseFloat(n[i].longitude),latitude:parseFloat(n[i].latitude),order:"A","production.node":n[i]["production.node"],"consumption.node":n[i]["consumption.node"]}):updateTransmissionGridViews["dataLines_"+t.target].push({indicator:testcase+"_"+n[i].name+"_"+n[i]["consumption.energy"],longitude:parseFloat(n[i].longitude),latitude:parseFloat(n[i].latitude),availability:parseFloat(n[i].availability),assetZone:n[i]["asset zone"],capex:n[i].capex,consumptionCost:n[i]["consumption cost"],consumptionEnergy:n[i]["consumption.energy"],consumptionNode:n[i]["consumption.node"],fixedOperatingCost:n[i]["fixed operating costs"],osses:n[i].losses,maxPmax:n[i]["max pmax"],minPmax:n[i]["min pmax"],name:n[i].name,pmax:n[i].pmax,productionEnergy:n[i]["production.energy"],productionNode:n[i]["production.node"],selectedBehaviors:n[i]["selected behaviors"],susceptance:n[i].susceptance,indicator:testcase+"_"+n[i].name+"_"+n[i]["consumption.energy"],longitude:parseFloat(n[i].longitude),latitude:parseFloat(n[i].latitude),order:"B","production.node":n[i]["production.node"],"consumption.node":n[i]["consumption.node"]})}else updateTransmissionGridViews["dataLines_"+t.target].push({indicator:testcase+"_"+n[i].name+"_"+n[i]["consumption.energy"],order:"A",longitude:parseFloat(n[i].longitude),latitude:parseFloat(n[i].latitude),"production.node":n[i]["production.node"],"consumption.node":n[i]["consumption.node"]});function o(e){const a=r.selectAll("path").attr("class","transmissionLine").data(updateTransmissionGridViews["dataLines_"+t.target]).join("path").attr("stroke","#aaa").attr("stroke-width",2).style("opacity",1).style("visibility",(function(t){return"A"==t.order?"visible":"hidden"})).attr("d","M20 100, L100 20"),s=()=>a.attr("d",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));return"M"+assetsOverviewMap.latLngToLayerPoint([a,i]).x+" "+assetsOverviewMap.latLngToLayerPoint([a,i]).y+" L"+assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).x+" "+assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).y})).attr("stroke-dasharray",0).attr("fill","none").attr("id",(function(e){return("trns_dataLines_"+t.target+"_"+e.indicator).replace(/\s/g,"")})).attr("stroke-dashoffset",0).attr("stroke",electricityGridColor).attr("data-gridScale",t.gridScale),n=r.selectAll(".capacities").data(updateTransmissionGridViews["dataLines_"+t.target]).attr("id",(function(t){return"netdeel_capacity"})).join("circle").attr("class","capacities").attr("fill","#FFF").attr("stroke","#aaa").style("pointer-events","all").style("opacity",1).attr("r",10).attr("cx",100).attr("cy",100).attr("id",(function(e,a){return("trnsCircles_dataLines_"+t.target+"_"+e.indicator).replace(/\s/g,"")})).attr("data-Indicators",(function(e){if(-1!=e.indicator.indexOf("_ELEX")){let t;t='["'+testcase+"_Elektriciteitstransport "+e["production.node"]+" to "+e["consumption.node"]+" _TRANS _ELIM _SOURCE_"+e["production.node"]+" _TARGET_"+e["consumption.node"]+'_electricity_production","'+testcase+"_Elektriciteitstransport "+e["consumption.node"]+" to "+e["production.node"]+" _TRANS _ELEX _SOURCE_"+e["consumption.node"]+" _TARGET_"+e["production.node"]+'_electricity_production"]'}else-1!=e.indicator.indexOf("_ELIM")?string='["'+testcase+"_Elektriciteitstransport "+e["production.node"]+" to "+e["consumption.node"]+" _TRANS _ELEX _SOURCE_"+e["production.node"]+" _TARGET_"+e["consumption.node"]+'_electricity_production","'+testcase+"_Elektriciteitstransport "+e["consumption.node"]+" to "+e["production.node"]+" _TRANS _ELIM _SOURCE_"+e["consumption.node"]+" _TARGET_"+e["production.node"]+'_electricity_production"]':string='["'+testcase+"_Elektriciteitstransport "+e["production.node"]+" to "+e["consumption.node"]+" _TRANS _SOURCE_"+e["production.node"]+" _TARGET_"+e["consumption.node"]+'_electricity_production","'+testcase+"_Elektriciteitstransport "+e["consumption.node"]+" to "+e["production.node"]+" _TRANS _SOURCE_"+e["consumption.node"]+" _TARGET_"+e["production.node"]+'_electricity_production"]';let a="trnsCircles_dataLines_"+t.target+"_"+e.indicator;return updateAssetBubbleIDs_Netten_precursor.push({index:i,pmax:e.pmax,domID:a.replace(/\s/g,""),twowayIndicators:JSON.parse(string),target:t.target,indicator:e.indicator}),string})).attr("data-Labels",(function(e){if(-1!=e.indicator.indexOf("_ELEX")){let t;t='["Transport van elektriciteit van '+e["production.node"]+" naar "+e["consumption.node"]+'","Transport van elektriciteit van'+e["consumption.node"]+" naar "+e["production.node"]+'"]'}else e.indicator.indexOf("_ELIM"),string='["Transport van elektriciteit van '+e["production.node"]+" naar "+e["consumption.node"]+'","Transport van elektriciteit van '+e["consumption.node"]+" naar "+e["production.node"]+'"]';let a="trnsCircles_dataLines_"+t.target+"_"+e.indicator;return updateAssetBubbleIDs_Netten_precursor.push({index:i,pmax:e.pmax,domID:a.replace(/\s/g,""),twowayIndicators:JSON.parse(string),target:t.target,indicator:e.indicator}),string})).on("click",(function(e){let a=JSON.parse(this.getAttribute("data-Indicators")),i=JSON.parse(this.getAttribute("data-Labels"));h(e,this,a,updateTransmissionGridViews["dataLines_"+t.target],i)})),o=()=>n.attr("cx",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));let r=assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).x-assetsOverviewMap.latLngToLayerPoint([a,i]).x;return assetsOverviewMap.latLngToLayerPoint([a,i]).x+.5*r})).attr("cy",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));let r=assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).y-assetsOverviewMap.latLngToLayerPoint([a,i]).y;return assetsOverviewMap.latLngToLayerPoint([a,i]).y+.5*r})).attr("dummy",(function(){drawNetdeelVollasturen({x:this.cx.animVal.value,y:this.cy.animVal.value,indicators:JSON.parse(this.getAttribute("data-Indicators")),config:t})})),l=r.selectAll(".Dots").attr("class","Dots").data(e.features).join("circle").attr("id",(function(t){return getNodeID(t.properties.Name)})).attr("fill","none").attr("stroke","none").attr("stroke-width",2).attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y)).attr("r",5).on("mouseover",(function(){d3.select(this).transition().duration(150).attr("fill","#333").attr("r",15)})).on("mouseout",(function(){d3.select(this).transition().duration(150).attr("fill","#333").attr("r",5)})).on("click",(function(t){nodeSelection=this.id,initAggregrates(),processData(rawDataInput)})).style("visibility","visible"),d=()=>l.attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y));s(),o(),assetsOverviewMap.on("zoomend",s),assetsOverviewMap.on("zoomend",d),assetsOverviewMap.on("zoomend",o)}o(s)}(),t.drawHydrogenGrid&&function(e){L.svg({clickable:!0}).addTo(assetsOverviewMap);const a=d3.select(assetsOverviewMap.getPanes().overlayPane),r=a.select("svg").attr("pointer-events","auto").append("g").attr("transform","translate(20,10)");r.attr("id","assetsViewSVGMapOverlay");var s={type:"FeatureCollection",features:[]};updateTransmissionGridViews["dataLines_"+t.target]=[];let n="2001";for(nodesData=loadedFiles.superGridContext.data_config_NODE,nodesDataStore=nodesData,i=0;i<nodesData.length;i++)s.features.push({type:"Feature",properties:{Name:nodesData[i].name},geometry:{type:"Point",coordinates:[parseFloat(nodesData[i].longitude),parseFloat(nodesData[i].latitude)]}});let o=loadedFiles.superGridContext.data_assets_HYDROGEN_PIPELINE;for(i=0;i<o.length;i++)if(updateTransmissionGridViews["dataLines_"+t.target].length>0){let e=!1;for(j=0;j<updateTransmissionGridViews["dataLines_"+t.target].length;j++)updateTransmissionGridViews["dataLines_"+t.target][j]["production.node"]==o[i]["consumption.node"]&&updateTransmissionGridViews["dataLines_"+t.target][j]["consumption.node"]==o[i]["production.node"]&&(e=!0);0==e?updateTransmissionGridViews["dataLines_"+t.target].push({availability:parseFloat(o[i].availability),assetZone:o[i]["asset zone"],capex:o[i].capex,consumptionCost:o[i]["consumption cost"],consumptionEnergy:o[i]["consumption.energy"],consumptionNode:o[i]["consumption.node"],fixedOperatingCost:o[i]["fixed operating costs"],losses:o[i].losses,maxPmax:o[i]["max pmax"],minPmax:o[i]["min pmax"],name:o[i].name,pmax:o[i].pmax,productionEnergy:o[i]["production.energy"],productionNode:o[i]["production.node"],selectedBehaviors:o[i]["selected behaviors"],susceptance:o[i].susceptance,indicator:n+"_"+o[i].name+"_"+o[i]["consumption.energy"],longitude:parseFloat(o[i].longitude),latitude:parseFloat(o[i].latitude),order:"A","production.node":o[i]["production.node"],"consumption.node":o[i]["consumption.node"]}):updateTransmissionGridViews["dataLines_"+t.target].push({indicator:n+"_"+o[i].name+"_"+o[i]["consumption.energy"],longitude:parseFloat(o[i].longitude),latitude:parseFloat(o[i].latitude),availability:parseFloat(o[i].availability),assetZone:o[i]["asset zone"],capex:o[i].capex,consumptionCost:o[i]["consumption cost"],consumptionEnergy:o[i]["consumption.energy"],consumptionNode:o[i]["consumption.node"],fixedOperatingCost:o[i]["fixed operating costs"],osses:o[i].losses,maxPmax:o[i]["max pmax"],minPmax:o[i]["min pmax"],name:o[i].name,pmax:o[i].pmax,productionEnergy:o[i]["production.energy"],productionNode:o[i]["production.node"],selectedBehaviors:o[i]["selected behaviors"],susceptance:o[i].susceptance,indicator:n+"_"+o[i].name+"_"+o[i]["consumption.energy"],longitude:parseFloat(o[i].longitude),latitude:parseFloat(o[i].latitude),order:"B","production.node":o[i]["production.node"],"consumption.node":o[i]["consumption.node"]})}else updateTransmissionGridViews["dataLines_"+t.target].push({indicator:n+"_"+o[i].name+"_"+o[i]["consumption.energy"],order:"A",longitude:parseFloat(o[i].longitude),latitude:parseFloat(o[i].latitude),"production.node":o[i]["production.node"],"consumption.node":o[i]["consumption.node"]});function l(e,a){const s=r.selectAll("path").attr("class","transmissionLine").data(updateTransmissionGridViews["dataLines_"+t.target]).join("path").attr("stroke","#aaa").attr("stroke-width",4).style("opacity",1).style("visibility",(function(t){return"A"==t.order?"visible":"hidden"})).attr("d","M20 100, L100 20"),o=()=>s.attr("d",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));return"M"+assetsOverviewMap.latLngToLayerPoint([a,i]).x+" "+assetsOverviewMap.latLngToLayerPoint([a,i]).y+" L"+assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).x+" "+assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).y})).attr("stroke-dasharray",0).attr("fill","none").attr("id",(function(e){return("trns_dataLines_"+t.target+"_"+e.indicator).replace(/\s/g,"")})).attr("stroke-dashoffset",0).attr("data-gridScale",t.gridScale).attr("stroke","#04543A"),l=r.selectAll(".capacities").data(updateTransmissionGridViews["dataLines_"+t.target]).attr("id",(function(t){return"netdeel_capacity"})).join("circle").attr("class","capacities").attr("fill","#FFF").attr("stroke","#aaa").style("pointer-events","all").style("opacity",1).attr("r",10).attr("cx",100).attr("cy",100).attr("id",(function(e,a){return("trnsCircles_dataLines_"+t.target+"_"+e.indicator).replace(/\s/g,"")})).attr("data-Indicators",(function(e){let a='["'+n+"_Waterstofpijplijn "+e["production.node"]+" to "+e["consumption.node"]+" _TRANS _SOURCE_"+e["production.node"]+" _TARGET_"+e["consumption.node"]+'_hydrogen_production","'+n+"_Waterstofpijplijn "+e["consumption.node"]+" to "+e["production.node"]+" _TRANS _SOURCE_"+e["consumption.node"]+" _TARGET_"+e["production.node"]+'_hydrogen_production"]',r="trnsCircles_dataLines_"+t.target+"_"+e.indicator;return updateAssetBubbleIDs_Netten_precursor.push({index:i,pmax:e.pmax,domID:r.replace(/\s/g,""),twowayIndicators:JSON.parse(a),target:t.target,indicator:e.indicator}),a})).attr("data-Labels",(function(t){return'["Transport van waterstof van '+t["production.node"]+" naar "+t["consumption.node"]+'","Transport van waterstof van '+t["consumption.node"]+" naar "+t["production.node"]+'"]'})).on("click",(function(e){let a=JSON.parse(this.getAttribute("data-Indicators")),i=JSON.parse(this.getAttribute("data-Labels"));h(e,this,a,updateTransmissionGridViews["dataLines_"+t.target],i)})),d=()=>l.attr("cx",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));let r=assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).x-assetsOverviewMap.latLngToLayerPoint([a,i]).x;return assetsOverviewMap.latLngToLayerPoint([a,i]).x+.5*r})).attr("cy",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));let r=assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).y-assetsOverviewMap.latLngToLayerPoint([a,i]).y;return assetsOverviewMap.latLngToLayerPoint([a,i]).y+.5*r})).attr("dummy",(function(){drawNetdeelVollasturen({x:this.cx.animVal.value,y:this.cy.animVal.value,indicators:JSON.parse(this.getAttribute("data-Indicators")),config:t})})),c=r.selectAll(".Dots").attr("class","Dots").data(e.features).join("circle").attr("id",(function(t){return getNodeID(t.properties.Name)})).attr("fill","none").attr("stroke","none").attr("stroke-width",2).attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y)).attr("r",5).on("mouseover",(function(){d3.select(this).transition().duration("150").attr("fill","#333").attr("r",15)})).on("mouseout",(function(){d3.select(this).transition().duration("150").attr("fill","#333").attr("r",5)})).on("click",(function(t){nodeSelection=this.id,initAggregrates(),processData(rawDataInput)})).style("visibility","visible"),u=()=>c.attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y));o(),d(),assetsOverviewMap.on("zoomend",o),assetsOverviewMap.on("zoomend",u),assetsOverviewMap.on("zoomend",d)}l(s,updateTransmissionGridViews["dataLines_"+t.target])}(),t.drawNaturalGasGrid&&function(e){L.svg({clickable:!0}).addTo(assetsOverviewMap);const a=d3.select(assetsOverviewMap.getPanes().overlayPane),r=a.select("svg").attr("pointer-events","auto").append("g").attr("transform","translate(20,10)");r.attr("id","assetsViewSVGMapOverlay");var s={type:"FeatureCollection",features:[]};updateTransmissionGridViews["dataLines_"+t.target]=[];let n="2001",o=loadedFiles.superGridContext.data_config_NODE;for(nodesDataStore=o,i=0;i<o.length;i++)s.features.push({type:"Feature",properties:{Name:o[i].name},geometry:{type:"Point",coordinates:[parseFloat(o[i].longitude),parseFloat(o[i].latitude)]}});let l=loadedFiles.superGridContext.data_assets_PIPELINE;for(i=0;i<l.length;i++)if(updateTransmissionGridViews["dataLines_"+t.target].length>0){let e=!1;for(j=0;j<updateTransmissionGridViews["dataLines_"+t.target].length;j++)updateTransmissionGridViews["dataLines_"+t.target][j]["production.node"]==l[i]["consumption.node"]&&updateTransmissionGridViews["dataLines_"+t.target][j]["consumption.node"]==l[i]["production.node"]&&(e=!0);0==e?updateTransmissionGridViews["dataLines_"+t.target].push({availability:parseFloat(l[i].availability),assetZone:l[i]["asset zone"],capex:l[i].capex,consumptionCost:l[i]["consumption cost"],consumptionEnergy:l[i]["consumption.energy"],consumptionNode:l[i]["consumption.node"],fixedOperatingCost:l[i]["fixed operating costs"],losses:l[i].losses,maxPmax:l[i]["max pmax"],minPmax:l[i]["min pmax"],name:l[i].name,pmax:l[i].pmax,productionEnergy:l[i]["production.energy"],productionNode:l[i]["production.node"],selectedBehaviors:l[i]["selected behaviors"],susceptance:l[i].susceptance,indicator:n+"_"+l[i].name+"_"+l[i]["consumption.energy"],longitude:parseFloat(l[i].longitude),latitude:parseFloat(l[i].latitude),order:"A","production.node":l[i]["production.node"],"consumption.node":l[i]["consumption.node"]}):updateTransmissionGridViews["dataLines_"+t.target].push({indicator:n+"_"+l[i].name+"_"+l[i]["consumption.energy"],longitude:parseFloat(l[i].longitude),latitude:parseFloat(l[i].latitude),availability:parseFloat(l[i].availability),assetZone:l[i]["asset zone"],capex:l[i].capex,consumptionCost:l[i]["consumption cost"],consumptionEnergy:l[i]["consumption.energy"],consumptionNode:l[i]["consumption.node"],fixedOperatingCost:l[i]["fixed operating costs"],osses:l[i].losses,maxPmax:l[i]["max pmax"],minPmax:l[i]["min pmax"],name:l[i].name,pmax:l[i].pmax,productionEnergy:l[i]["production.energy"],productionNode:l[i]["production.node"],selectedBehaviors:l[i]["selected behaviors"],susceptance:l[i].susceptance,indicator:n+"_"+l[i].name+"_"+l[i]["consumption.energy"],longitude:parseFloat(l[i].longitude),latitude:parseFloat(l[i].latitude),order:"B","production.node":l[i]["production.node"],"consumption.node":l[i]["consumption.node"]})}else updateTransmissionGridViews["dataLines_"+t.target].push({indicator:n+"_"+l[i].name+"_"+l[i]["consumption.energy"],order:"A",longitude:parseFloat(l[i].longitude),latitude:parseFloat(l[i].latitude),"production.node":l[i]["production.node"],"consumption.node":l[i]["consumption.node"]});function d(e,a){const s=r.selectAll("path").attr("class","transmissionLine").data(updateTransmissionGridViews["dataLines_"+t.target]).join("path").attr("stroke","#aaa").attr("stroke-width",4).style("opacity",1).style("visibility",(function(t){return"A"==t.order?"visible":"hidden"})).attr("d","M20 100, L100 20"),o=()=>s.attr("d",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));return"M"+assetsOverviewMap.latLngToLayerPoint([a,i]).x+" "+assetsOverviewMap.latLngToLayerPoint([a,i]).y+" L"+assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).x+" "+assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).y})).attr("stroke-dasharray",0).attr("fill","none").attr("id",(function(e){return("trns_dataLines_"+t.target+"_"+e.indicator).replace(/\s/g,"")})).attr("stroke-dashoffset",0).attr("data-gridScale",t.gridScale).attr("stroke","#022A7A"),l=r.selectAll(".capacities").data(updateTransmissionGridViews["dataLines_"+t.target]).attr("id",(function(t){return"netdeel_capacity"})).join("circle").attr("class","capacities").attr("fill","#FFF").attr("stroke","#aaa").style("pointer-events","all").style("opacity",1).attr("r",10).attr("cx",100).attr("cy",100).attr("id",(function(e,a){return console.log(e),("trnsCircles_dataLines_"+t.target+"_"+e.indicator).replace(/\s/g,"")})).attr("data-Indicators",(function(e){let a='["'+n+"_Aardgastransportnet "+e["production.node"]+" to "+e["consumption.node"]+" _TRANS _SOURCE_"+e["production.node"]+" _TARGET_"+e["consumption.node"]+'_gas_production","'+n+"_Aardgastransportnet "+e["consumption.node"]+" to "+e["production.node"]+" _TRANS _SOURCE_"+e["consumption.node"]+" _TARGET_"+e["production.node"]+'_gas_production"]',r="trnsCircles_dataLines_"+t.target+"_"+e.indicator;return updateAssetBubbleIDs_Netten_precursor.push({index:i,pmax:e.pmax,domID:r.replace(/\s/g,""),twowayIndicators:JSON.parse(a),target:t.target,indicator:e.indicator}),a})).attr("data-Labels",(function(t){return'["Transport van methaan van '+t["production.node"]+" naar "+t["consumption.node"]+'","Transport van methaan van '+t["consumption.node"]+" naar "+t["production.node"]+'"]'})).on("click",(function(e){let a=JSON.parse(this.getAttribute("data-Indicators")),i=JSON.parse(this.getAttribute("data-Labels"));h(e,this,a,updateTransmissionGridViews["dataLines_"+t.target],i)})),d=()=>l.attr("cx",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));let r=assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).x-assetsOverviewMap.latLngToLayerPoint([a,i]).x;return assetsOverviewMap.latLngToLayerPoint([a,i]).x+.5*r})).attr("cy",(function(t){var a=0,i=0;for(j=0;j<e.features.length;j++)t["production.node"]==e.features[j].properties.Name&&(a=parseFloat(e.features[j].geometry.coordinates[1]),i=parseFloat(e.features[j].geometry.coordinates[0])),t["consumption.node"]==e.features[j].properties.Name&&(lat2=parseFloat(e.features[j].geometry.coordinates[1]),lng2=parseFloat(e.features[j].geometry.coordinates[0]));let r=assetsOverviewMap.latLngToLayerPoint([lat2,lng2]).y-assetsOverviewMap.latLngToLayerPoint([a,i]).y;return assetsOverviewMap.latLngToLayerPoint([a,i]).y+.5*r})).attr("dummy",(function(){drawNetdeelVollasturen({x:this.cx.animVal.value,y:this.cy.animVal.value,indicators:JSON.parse(this.getAttribute("data-Indicators")),config:t})})),c=r.selectAll(".Dots").attr("class","Dots").data(e.features).join("circle").attr("id",(function(t){return getNodeID(t.properties.Name)})).attr("fill","none").attr("stroke","none").attr("stroke-width",2).attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y)).attr("r",5).on("mouseover",(function(){d3.select(this).transition().duration("150").attr("fill","#333").attr("r",15)})).on("mouseout",(function(){d3.select(this).transition().duration("150").attr("fill","#333").attr("r",5)})).on("click",(function(t){nodeSelection=this.id,initAggregrates(),processData(rawDataInput)})).style("visibility","visible"),u=()=>c.attr("cx",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).x)).attr("cy",(t=>assetsOverviewMap.latLngToLayerPoint([t.geometry.coordinates[1],t.geometry.coordinates[0]]).y));o(),d(),assetsOverviewMap.on("zoomend",o),assetsOverviewMap.on("zoomend",u),assetsOverviewMap.on("zoomend",d)}d(s,updateTransmissionGridViews["dataLines_"+t.target])}(),mainAssetViewLoadedStatusFlag&&setTimeout((()=>{}),500)}function drawNetdeelVollasturen(t){let e=.8,a=0;for(i=0;i<timeseriesLib.length;i++)a+=parseFloat(timeseriesLib[i][t.indicators[0]]),a+=parseFloat(timeseriesLib[i][t.indicators[1]]);let r=0;for(i=0;i<loadedFiles.assetsOverview.length;i++){var s="";s="production.energy"==t.config.focus?loadedFiles.assetsOverview[i]["production.energy"]:loadedFiles.assetsOverview[i]["consumption.energy"],loadedFiles.assetsOverview[i].indicator+s+"_production"!=t.indicators[0]&&loadedFiles.assetsOverview[i].indicator+s+"_production"!=t.indicators[1]||"pmax"in loadedFiles.assetsOverview[i]&&parseInt(loadedFiles.assetsOverview[i].pmax)>r&&(r=parseInt(loadedFiles.assetsOverview[i].pmax))}capacityFactor=a/(8760*r),e=capacityFactor;let n=t.x+19.5,o=t.y+9.5;var l=d3.select("#"+t.config.target+"_overlaySVG").append("g").attr("id","donutChartElementNetbelastingG").attr("transform","translate("+n+","+o+")"),d=d3.arc().innerRadius(8).outerRadius(11),c=d3.arc().innerRadius(8).outerRadius(11).startAngle(0).endAngle(2*Math.PI),u=d3.pie().value((function(t){return t}));l.append("path").attr("id","donutChartElement_"+drawNetdeelVollasturen_callCounter).attr("class","arc-background").attr("d",c).attr("fill","#999"),l.selectAll("path").data(u([0,0])).enter().append("path").attr("class","arc-netbelasting-path").attr("id","donutChartElement_"+drawNetdeelVollasturen_callCounter).attr("d",d).attr("fill","#eee").transition().duration(500).attrTween("d",(function(t){var a=d3.interpolate(t.endAngle,e/1*2*Math.PI);return function(e){return t.endAngle=a(e),d(t)}})),drawNetdeelVollasturen_callCounter++}function numberWithThousandsSeperator(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function initDonutCharts(){for(updateAssetBubbleIDs_ready=[],i=0;i<updateAssetBubbleIDs_precursor.length;i++)updateAssetBubbleIDs_ready.push({index:i,svg:d3.select("#"+updateAssetBubbleIDs_precursor[i].target+"_overlaySVG3").append("g").attr("id","donutChartGelement_"+updateAssetBubbleIDs_precursor[i].target+"_"+i).attr("transform","translate("+d3.select("#"+updateAssetBubbleIDs_precursor[i].domID).attr("cx")+","+d3.select("#"+updateAssetBubbleIDs_precursor[i].domID).attr("cy")+")"),target:updateAssetBubbleIDs_precursor[i].target,indicator:updateAssetBubbleIDs_precursor[i].indicator,maxvalue:updateAssetBubbleIDs_precursor[i].value,radius:d3.select("#"+updateAssetBubbleIDs_precursor[i].domID).attr("r"),pie:d3.pie().value((function(t){return t}))});var t={a:20,b:30},e=d3.pie(d3.entries()).value((function(t){return t.value})).sort(null),a=["black","none"];for(q=0;q<updateAssetBubbleIDs_ready.length;q++)updateAssetBubbleIDs_ready[q].svg.append("g").selectAll(".donutSupply_"+q).data(e(d3.entries(t))).enter().append("path").attr("id","donutChartElement").attr("data-radius",updateAssetBubbleIDs_ready[q].radius).attr("class","donutSupply_"+q).attr("fill",(function(t,e){return a[e]})).style("opacity",1)}function toggleDetailsIndicators(){detailsIndicatorStatusFlag?(detailsIndicatorStatusFlag=!1,d3.selectAll(".detailsIndicator").style("visibility","hidden")):(detailsIndicatorStatusFlag=!0,d3.selectAll(".detailsIndicator").style("visibility","visible"))}function getTextWidth(t,e,a){const i=document.createElement("span");i.style.fontSize=e,i.style.fontFamily=a,i.textContent=t,document.body.appendChild(i);const r=i.offsetWidth;return document.body.removeChild(i),r}drawNetdeelVollasturen_callCounter=0;