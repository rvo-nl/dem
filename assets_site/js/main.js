let obj,offsetTracker,loop,aggregrates,scaleDataValue,loadedFiles,cfgSeries,selectedTestCase="2001",nodeSelection="NL",temporalViewMode="realtime",residualLoadDurationCurve_data={};const zipFileSize=70;let detailsIndicatorStatusFlag=!1,mainAssetViewLoadedStatusFlag=!1,sankeyDiagramCurrentUnit="GW",excludeNodesFromVisuals=["AT","SE","ES","IE","NI","CH","PT","FRANCE","IT","LU"],transmissionLinesVisualSelection=["Zuid-Holland","Noord-Holland","Groningen","Utrecht","Gelderland","Zeeland","Noord-Brabant","Overijssel","Fryslan","Drenthe","Flevoland","Limburg","Wind-Op-Zee"],interconnectorNodes=["GB","DE","BE","NO","DK"],sankeyfyConfig={xlsxURL:"assets_data/data_gensankey.xlsx",targetDIV:"dynSankey",margins:{vertical:120,horizontal:200},sankeyData:null,legend:null,settings:null};d3.select("#loadScreen-svgContainer").append("svg").style("width","100%").style("height","100%").attr("id","loadScreen_SVG");let loadScreenCanvas=d3.select("#loadScreen_SVG").append("g");const middleX=document.querySelector("#loadScreen-svgContainer").offsetWidth/2,middleY=document.querySelector("#loadScreen-svgContainer").offsetHeight/2,basePosX=middleX+180,basePosY=middleY+250;loadScreenCanvas.append("text").attr("x",200).attr("y",200).style("font-size","40px").text("Dashboard Model Energiesysteem"),loadScreenCanvas.append("text").attr("x",basePosX).attr("y",basePosY-70).style("font-size","30px").text("Dashboard wordt geladen"),loadScreenCanvas.append("text").attr("id","loadScreen_statusText_step1").attr("x",basePosX).attr("y",basePosY).text("Data downloaden (70 MB)..."),loadScreenCanvas.append("text").attr("id","loadScreen_statusText_step2").attr("x",basePosX).attr("y",basePosY+50).text("Data verwerken"),loadScreenCanvas.append("text").attr("id","loadScreen_statusText_step3").attr("x",basePosX).attr("y",basePosY+100).text("Data visualiseren");const checkerSymbol="M10,18a1,1,0,0,1-.71-.29l-5-5a1,1,0,0,1,1.42-1.42L10,15.59l8.29-8.3a1,1,0,1,1,1.42,1.42l-9,9A1,1,0,0,1,10,18Z";let posx=basePosX-50,posy=basePosY-28;async function executeSequentially(){d3.select("#loadscreenActivityIndicator").style("left",basePosX-50+"px").style("top",basePosY-23+"px"),await new Promise((e=>setTimeout(e,10))),await loadFiles(),d3.select("#loadScreen_statusIcon_step1").style("visibility","visible"),d3.select("#loadScreen_statusText_step1").text("Download compleet"),d3.select("#loadScreen_statusText_step2").text("Data verwerken..."),d3.select("#loadscreenActivityIndicator").style("left",basePosX-50+"px").style("top",basePosY-23+50+"px"),await new Promise((e=>setTimeout(e,10))),await drawTimeline(),await new Promise((e=>setTimeout(e,10))),await processAggregates(loadedFiles.testOutput),d3.select("#loadScreen_statusIcon_step2").style("visibility","visible"),d3.select("#loadScreen_statusText_step2").text("Verwerking compleet"),d3.select("#loadScreen_statusText_step3").text("Data visualiseren..."),d3.select("#loadscreenActivityIndicator").style("left",basePosX-50+"px").style("top",basePosY-23+100+"px"),await new Promise((e=>setTimeout(e,10))),await drawDynamicSankey(sankeyfyConfig,loadedFiles.sankeyXLSX),timeseriesLib=loadedFiles.resultsLib,await new Promise((e=>setTimeout(e,10))),await initOverviews(loadedFiles.assetsOverview),initPlayer(),d3.select("#loadScreen").remove()}loadScreenCanvas.append("path").attr("id","loadScreen_statusIcon_step1").attr("d",checkerSymbol).attr("fill","green").attr("transform","translate("+posx+","+posy+")scale(1.5)").style("visibility","hidden"),posy+=50,loadScreenCanvas.append("path").attr("id","loadScreen_statusIcon_step2").attr("d",checkerSymbol).attr("fill","green").attr("transform","translate("+posx+","+posy+")scale(1.5)").style("visibility","hidden"),posy+=50,loadScreenCanvas.append("path").attr("id","loadScreen_statusIcon_step3").attr("d",checkerSymbol).attr("fill","green").attr("transform","translate("+posx+","+posy+")scale(1.5)").style("visibility","hidden"),executeSequentially();