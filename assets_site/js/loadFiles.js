let asset_types_lookup_table={},energy_vectors_lookup_table={};const files=[{tag:"testOutput",url:"assets_data/testoutput.xlsx"},{tag:"resultsLib",url:"assets_data/resultsLib.csv.zip"},{tag:"assetsOverview",url:"assets_data/assetsOverview.xlsx"},{tag:"sankeyXLSX",url:"assets_data/data_gensankey.xlsx"},{tag:"superGridContext",url:"assets_data/superGridContext.zip"}];function loadFiles(){return new Promise((e=>{(async function(e){try{const t={},s=e.map((async(e,s)=>{switch(e.tag){case"testOutput":var a=await(n=e.url,new Promise((function(e,t){var s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType="arraybuffer",s.onload=function(t){var a=XLSX.read(s.response),n=XLSX.utils.sheet_to_json(a.Sheets.results);e(n)},s.onerror=function(e){t(e)},s.send()})));t[`${e.tag}`]=a;break;case"resultsLib":a=await loadResultsLibZIP(e.url);t[`${e.tag}`]=a;break;case"assetsOverview":a=await function(e){return new Promise((function(t,s){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(e){var s=XLSX.read(a.response),n=XLSX.utils.sheet_to_json(s.Sheets.assets);for(i=0;i<n.length;i++){if(void 0!==n[i].outputData){let e=JSON.parse(n[i].outputData);n[i].outputData=e}if(void 0!==n[i].inputData){let e=JSON.parse(n[i].inputData);n[i].inputData=e}}t(n)},a.onerror=function(e){s(e)},a.send()}))}(e.url);t[`${e.tag}`]=a;break;case"sankeyXLSX":a=await readExcelFile(e.url);t[`${e.tag}`]=a;break;case"superGridContext":a=await loadSuperGridContextZIP(e.url);t[`${e.tag}`]=a;break;default:console.log("WARNING: unknown instruction tag")}var n}));return await Promise.all(s),t}catch(e){throw console.error("Error fetching data:",e),e}})(files).then((t=>{loadedFiles=t,e()}))}))}function readExcelFile(e){return new Promise((function(t,s){const a=new XMLHttpRequest;a.onload=()=>{const e=a.response,s=XLSX.read(e,{type:"array"});let n={},r={},i={},o={};s.SheetNames.forEach((e=>{const t=s.Sheets[e];switch(e){case"links":n=XLSX.utils.sheet_to_json(t);break;case"nodes":r=XLSX.utils.sheet_to_json(t);break;case"legend":i=XLSX.utils.sheet_to_json(t);break;case"settings":o=XLSX.utils.sheet_to_json(t);break;case"asset_types":asset_types_lookup_table=XLSX.utils.sheet_to_json(t);break;case"energy_vectors":energy_vectors_lookup_table=XLSX.utils.sheet_to_json(t)}})),t({links:n,nodes:r,legend:i,settings:o})},a.open("GET",e,!0),a.responseType="arraybuffer",a.send()}))}function loadResultsLib(e){return d3.csv(e).then((function(e){return timeseriesLib=e,e}))}function loadResultsLibZIP(e){return new Promise(((t,s)=>{fetch(e).then((e=>{if(!e.ok)throw new Error("Failed to fetch the resultsLib .zip file.");return e.arrayBuffer()})).then((e=>unzipResultsLibCSV(e))).then((e=>{Papa.parse(e,{delimiter:",",header:!0,skipEmptyLines:!0,complete:function(e){const s=e.data;timeseriesLib=s,t(s)},error:function(e){s(e.message)}})})).catch((e=>{s(e.message)}))}))}function loadSuperGridContextZIP(e){return new Promise(((t,s)=>{fetch(e).then((e=>{if(!e.ok)throw new Error("Failed to fetch the superGridContext .zip file.");return e.arrayBuffer()})).then((e=>unzipSuperGridContextCSVs(e))).then((e=>{t(e)})).catch((e=>{s(e.message)}))}))}async function unzipResultsLibCSV(e){try{const t=new JSZip,s=await t.loadAsync(e),a=Object.keys(s.files).find((e=>e.endsWith(".csv")));if(!a)throw new Error("No CSV file found in the .zip");return await s.files[a].async("text")}catch(e){throw e}}async function unzipSuperGridContextCSVs(e){try{const t=new JSZip,s=await t.loadAsync(e);let a={};return a.data_config_NODE=await s.files["Context_data/NODE.csv"].async("text"),a.data_assets_TRANSMISSION=await s.files["Assets/TRANSMISSION.csv"].async("text"),a.data_assets_PIPELINE=await s.files["Assets/PIPELINE.csv"].async("text"),a.data_assets_HYDROGEN_PIPELINE=await s.files["Assets/HYDROGEN_PIPELINE.csv"].async("text"),parseCSV({delimiter:";",header:!0,skipEmptyLines:!0},a.data_config_NODE).then((e=>{a.data_config_NODE=e})),parseCSV({delimiter:";",header:!0,skipEmptyLines:!0},a.data_assets_TRANSMISSION).then((e=>{a.data_assets_TRANSMISSION=e})),parseCSV({delimiter:";",header:!0,skipEmptyLines:!0},a.data_assets_PIPELINE).then((e=>{a.data_assets_PIPELINE=e})),parseCSV({delimiter:";",header:!0,skipEmptyLines:!0},a.data_assets_HYDROGEN_PIPELINE).then((e=>{a.data_assets_HYDROGEN_PIPELINE=e})),a}catch(e){throw e}}function parseCSV(e,t){return new Promise(((s,a)=>{Papa.parse(t,{delimiter:e.delimiter,header:e.header,skipEmptyLines:e.skipEmptyLines,complete:function(e){s(e.data)},error:function(e){a(e.message)}})}))}